Code used to generate sensitivity estimates for Amdur et al. 2020 (in rev.).
The four primary scripts of this toolbox have been run successfully from 
an installation of Matlab 2018b with the Statistics toolbox and signal 
processing toolbox installed. Updated as of October 21, 2020.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Data:

AMO: See AMO_availability for data sources

Anthropogenic: See ENSO_availability for data sources

code_generated: See code_generated_info for data structure information

ENSO: See AMO_availability for data sources

IPO: See IPO_availability for data sources

Temperature: See Temperature_availability

TSI: See TSI_availability for data sources

Volcanism: See Volcanism_availability for data sources

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Code: (Following main scripts must be called while in Code directory)

calcfig4: Perform sensitivity calculations used to generate Fig. 4

calctable2: Perform calculations of sensitivity estimates provided in table 2
            of manuscript

cmdsensitivity: Script to perform CMD sensitivity estimate. User-specified 
                parameters are specified in initial lines.

mlrlikelihood: Modified version of mlrsensitivity with function inputs 
               replacing user inputs in order to generate relative likelihoods 
               for Figure 2

mlrsensitivity: Script to perform MLR sensitivity estimate. User-specified 
                parameters are specified in initial lines.

---cmip_mlr
--->makemlrcontrol: Run cmipreg for all available cmip control runs, returning set 
    of all estimated sensitivities and other ancillary data. CMIP experiment
    data not included in toolbox due to size, and is available upon request.
--->makemlrhistorical: Run cmipreg for all cmip historical runs, 
    returning set of all estimated sensitivities. CMIP experiment
    data not included in toolbox due to size, and is available upon request.

---prepare_predictors
--->calcnino34: Given 3-D spatial field of sea surface temperature values in
    X, Y, T, return calculation of NiÃ±o 3.4 index following prescription from
    https://climatedataguide.ucar.edu/climate-data/nino-sst-indices-nino-12-3-34-4-oni-and-tni
--->loadallforcing: Call each external forcing script to generate a structure
    array that provides common indexing and formatting for predictor time series
    used in MLR. fields available in each structure object include: 
    yr (year, length N), type, preds (NxM array with predictor values), 
    sources (length M). NOTE: MUST BE CALLED IN /CODE DIRECTORY
--->loadamo: Return structure array with standardized indexing for years/months
    the PSL AMO index. Note that annual record generated by averaging monthly 
    monthly records. Indexed beginning in 1850 in accordance with 
    loadallforcing formatting.
--->loadanth: Return structure array with standardized indexing for years/months
    of effective radiative forcing records. Note that annual record generated
    by averaging monthly monthly records. Indexed beginning in 1850 in 
    accordance with loadallforcing formatting.
--->loadenso: Return structure array with standardized indexing for years/months
    of ENSO reconstruction data sets. Note that annual record generated
    by averaging monthly monthly records. Indexed beginning in 1850 in 
    accordance with loadallforcing formatting.
--->loadipo: Return structure array with standardized indexing for years/months
    of IPO reconstruction data sets. Note that annual record generated
    by averaging monthly monthly records. Indexed beginning in 1850 in 
    accordance with loadallforcing formatting.
--->loadtsi: Return structure array with standardized indexing for years/months
    of TSI reconstruction data sets. Note that annual record generated
    by averaging monthly monthly records. Indexed beginning in 1850 in 
    accordance with loadallforcing formatting.
--->loadvol: Return structure array with standardized indexing for years/months
    of volcanic aerosol reconstruction data sets. Note that annual record generated
    by averaging monthly monthly records. Indexed beginning in 1850 in 
    accordance with loadallforcing formatting.
--->makemei: combine extended mei and mei data sets, from text files provided
    at https://psl.noaa.gov/enso/, to produce MEI reconstruction assimilated
    by loadenso.m. NOTE: MUST BE CALLED WHEN IN /CODE DIRECTORY
--->prepcmip6vol: From the 550nm stratospheric aerosol extinction coefficient
    4-Var file used to force CMIP6 historical experiments, create global 
    mean 550 nm aerosol optical depth to be used as a volcanic predictor

---prepare_temperature
--->s1a1preparehadcrut: Process HadCRUT nc files to return 3-D Spatial field
    with units X,Y,T
--->s1a1preparehadcrutmonthly: Process HadCRUT4 txt file to return global mean
    temperature anomaly and corresponding date as two column table
--->s1a3prepareberkeley: Process Berkeley Earth global temperature anomaly
    dataset
--->s1a4preparegiss: Process GISTEMP4 global temperature anomaly
    dataset
--->s1apreparencep25: Process 2.5x2.5 degree resolution NCEP reanalysis nc 
    file. Returns 3-D spatial field of near-surface temperature anomalies
    with units X, Y, T.
--->s1preparehadcrut3: Process HadCRUT3 txt file to return global mean
    temperature anomaly and corresponding date (as year, month, and fractional
    year).

---tools (not exhaustive)
--->allcomb: called by mlrsensitivity and searchlags to return all combinations
    of valid lags for the predictors used in the mlr model.
--->phaserandomcmd: Produce lower and upper bounds of confidence interval for CMD
    using iter instances of phase randomization.
--->phaserandommlr: Produce lower and upper bounds of confidence interval for MLR
    using iter instances of phase randomization.
--->phaserandomize: Called by phaserandommlr to perform phase randomization
--->searchlags: used by makemlrhistorical.m and makemlrcontrol.m to find 
    a set of lags for chosen predictors that maximizes explained variance.
--->takespatialavgmonthly: Given 3-D spatial field of values in X,Y,T, return 
    global-mean monthly time series with spatial weigthing for gridbox location.